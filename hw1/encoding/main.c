#include <stdio.h>
#include <string.h>

unsigned cp1251_to_utf8[] = {
    [0x00] = 0x00,     // NULL
    [0x01] = 0x01,     // SOH
    [0x02] = 0x02,     // STX
    [0x03] = 0x03,     // ETX
    [0x04] = 0x04,     // EOT
    [0x05] = 0x05,     // ENQ
    [0x06] = 0x06,     // ACK
    [0x07] = 0x07,     // BEL
    [0x08] = 0x08,     // BS
    [0x09] = 0x09,     // TAB
    [0x0A] = 0x0A,     // LF
    [0x0B] = 0x0B,     // VT
    [0x0C] = 0x0C,     // FF
    [0x0D] = 0x0D,     // CR
    [0x0E] = 0x0E,     // SO
    [0x0F] = 0x0F,     // SI
    [0x10] = 0x10,     // DLE
    [0x11] = 0x11,     // DC1
    [0x12] = 0x12,     // DC2
    [0x13] = 0x13,     // DC3
    [0x14] = 0x14,     // DC4
    [0x15] = 0x15,     // NAK
    [0x16] = 0x16,     // SYN
    [0x17] = 0x17,     // ETB
    [0x18] = 0x18,     // CAN
    [0x19] = 0x19,     // EM
    [0x1A] = 0x1A,     // SUB
    [0x1B] = 0x1B,     // ESC
    [0x1C] = 0x1C,     // FS
    [0x1D] = 0x1D,     // GS
    [0x1E] = 0x1E,     // RS
    [0x1F] = 0x1F,     // US
    [0x20] = 0x20,     // Space
    [0x21] = 0x21,     // !
    [0x22] = 0x22,     // "
    [0x23] = 0x23,     // #
    [0x24] = 0x24,     // $
    [0x25] = 0x25,     // %
    [0x26] = 0x26,     // &
    [0x27] = 0x27,     // '
    [0x28] = 0x28,     // (
    [0x29] = 0x29,     // )
    [0x2A] = 0x2A,     // *
    [0x2B] = 0x2B,     // +
    [0x2C] = 0x2C,     // ,
    [0x2D] = 0x2D,     // -
    [0x2E] = 0x2E,     // .
    [0x2F] = 0x2F,     // /
    [0x30] = 0x30,     // 0
    [0x31] = 0x31,     // 1
    [0x32] = 0x32,     // 2
    [0x33] = 0x33,     // 3
    [0x34] = 0x34,     // 4
    [0x35] = 0x35,     // 5
    [0x36] = 0x36,     // 6
    [0x37] = 0x37,     // 7
    [0x38] = 0x38,     // 8
    [0x39] = 0x39,     // 9
    [0x3A] = 0x3A,     // :
    [0x3B] = 0x3B,     // ;
    [0x3C] = 0x3C,     // <
    [0x3D] = 0x3D,     // =
    [0x3E] = 0x3E,     // >
    [0x3F] = 0x3F,     // ?
    [0x40] = 0x40,     // @
    [0x41] = 0x41,     // A
    [0x42] = 0x42,     // B
    [0x43] = 0x43,     // C
    [0x44] = 0x44,     // D
    [0x45] = 0x45,     // E
    [0x46] = 0x46,     // F
    [0x47] = 0x47,     // G
    [0x48] = 0x48,     // H
    [0x49] = 0x49,     // I
    [0x4A] = 0x4A,     // J
    [0x4B] = 0x4B,     // K
    [0x4C] = 0x4C,     // L
    [0x4D] = 0x4D,     // M
    [0x4E] = 0x4E,     // N
    [0x4F] = 0x4F,     // O
    [0x50] = 0x50,     // P
    [0x51] = 0x51,     // Q
    [0x52] = 0x52,     // R
    [0x53] = 0x53,     // S
    [0x54] = 0x54,     // T
    [0x55] = 0x55,     // U
    [0x56] = 0x56,     // V
    [0x57] = 0x57,     // W
    [0x58] = 0x58,     // X
    [0x59] = 0x59,     // Y
    [0x5A] = 0x5A,     // Z
    [0x5B] = 0x5B,     // [
    [0x5C] = 0x5C,     // Backslash
    [0x5D] = 0x5D,     // ]
    [0x5E] = 0x5E,     // ^
    [0x5F] = 0x5F,     // _
    [0x60] = 0x60,     // `
    [0x61] = 0x61,     // a
    [0x62] = 0x62,     // b
    [0x63] = 0x63,     // c
    [0x64] = 0x64,     // d
    [0x65] = 0x65,     // e
    [0x66] = 0x66,     // f
    [0x67] = 0x67,     // g
    [0x68] = 0x68,     // h
    [0x69] = 0x69,     // i
    [0x6A] = 0x6A,     // j
    [0x6B] = 0x6B,     // k
    [0x6C] = 0x6C,     // l
    [0x6D] = 0x6D,     // m
    [0x6E] = 0x6E,     // n
    [0x6F] = 0x6F,     // o
    [0x70] = 0x70,     // p
    [0x71] = 0x71,     // q
    [0x72] = 0x72,     // r
    [0x73] = 0x73,     // s
    [0x74] = 0x74,     // t
    [0x75] = 0x75,     // u
    [0x76] = 0x76,     // v
    [0x77] = 0x77,     // w
    [0x78] = 0x78,     // x
    [0x79] = 0x79,     // y
    [0x7A] = 0x7A,     // z
    [0x7B] = 0x7B,     // {
    [0x7C] = 0x7C,     // |
    [0x7D] = 0x7D,     // }
    [0x7E] = 0x7E,     // ~
    [0x7F] = 0x7F,     // DEL
    [0xC0] = 0xD090,  // À
    [0xC1] = 0xD091,  // Á
    [0xC2] = 0xD092,  // Â
    [0xC3] = 0xD093,  // Ã
    [0xC4] = 0xD094,  // Ä
    [0xC5] = 0xD095,  // Å
    [0xC6] = 0xD096,  // Æ
    [0xC7] = 0xD097,  // Ç
    [0xC8] = 0xD098,  // È
    [0xC9] = 0xD099,  // É
    [0xCA] = 0xD09A,  // Ê
    [0xCB] = 0xD09B,  // Ë
    [0xCC] = 0xD09C,  // Ì
    [0xCD] = 0xD09D,  // Í
    [0xCE] = 0xD09E,  // Î
    [0xCF] = 0xD09F,  // Ï
    [0xD0] = 0xD0A0,  // Ð
    [0xD1] = 0xD0A1,  // Ñ
    [0xD2] = 0xD0A2,  // Ò
    [0xD3] = 0xD0A3,  // Ó
    [0xD4] = 0xD0A4,  // Ô
    [0xD5] = 0xD0A5,  // Õ
    [0xD6] = 0xD0A6,  // Ö
    [0xD7] = 0xD0A7,  // ×
    [0xD8] = 0xD0A8,  // Ø
    [0xD9] = 0xD0A9,  // Ù
    [0xDA] = 0xD0AA,  // Ú
    [0xDB] = 0xD0AB,  // Û
    [0xDC] = 0xD0AC,  // Ü
    [0xDD] = 0xD0AD,  // Ý
    [0xDE] = 0xD0AE,  // Þ
    [0xDF] = 0xD0AF,  // ß
    [0xE0] = 0xD0B0,  // à
    [0xE1] = 0xD0B1,  // á
    [0xE2] = 0xD0B2,  // â
    [0xE3] = 0xD0B3,  // ã
    [0xE4] = 0xD0B4,  // ä
    [0xE5] = 0xD0B5,  // å
    [0xE6] = 0xD0B6,  // æ
    [0xE7] = 0xD0B7,  // ç
    [0xE8] = 0xD0B8,  // è
    [0xE9] = 0xD0B9,  // é
    [0xEA] = 0xD0BA,  // ê
    [0xEB] = 0xD0BB,  // ë
    [0xEC] = 0xD0BC,  // ì
    [0xED] = 0xD0BD,  // í
    [0xEE] = 0xD0BE,  // î
    [0xEF] = 0xD0BF,  // ï
    [0xF0] = 0xD180,  // ð
    [0xF1] = 0xD181,  // ñ
    [0xF2] = 0xD182,  // ò
    [0xF3] = 0xD183,  // ó
    [0xF4] = 0xD184,  // ô
    [0xF5] = 0xD185,  // õ
    [0xF6] = 0xD186,  // ö
    [0xF7] = 0xD187,  // ÷
    [0xF8] = 0xD188,  // ø
    [0xF9] = 0xD189,  // ù
    [0xFA] = 0xD18A,  // ú
    [0xFB] = 0xD18B,  // û
    [0xFC] = 0xD18C,  // ü
    [0xFD] = 0xD18D,  // ý
    [0xFE] = 0xD18E,  // þ
    [0xFF] = 0xD18F   // ÿ
};

unsigned koi8r_to_utf8[] = {
    [0x00] = 0x00,     // NULL
    [0x01] = 0x01,     // SOH
    [0x02] = 0x02,     // STX
    [0x03] = 0x03,     // ETX
    [0x04] = 0x04,     // EOT
    [0x05] = 0x05,     // ENQ
    [0x06] = 0x06,     // ACK
    [0x07] = 0x07,     // BEL
    [0x08] = 0x08,     // BS
    [0x09] = 0x09,     // TAB
    [0x0A] = 0x0A,     // LF
    [0x0B] = 0x0B,     // VT
    [0x0C] = 0x0C,     // FF
    [0x0D] = 0x0D,     // CR
    [0x0E] = 0x0E,     // SO
    [0x0F] = 0x0F,     // SI
    [0x10] = 0x10,     // DLE
    [0x11] = 0x11,     // DC1
    [0x12] = 0x12,     // DC2
    [0x13] = 0x13,     // DC3
    [0x14] = 0x14,     // DC4
    [0x15] = 0x15,     // NAK
    [0x16] = 0x16,     // SYN
    [0x17] = 0x17,     // ETB
    [0x18] = 0x18,     // CAN
    [0x19] = 0x19,     // EM
    [0x1A] = 0x1A,     // SUB
    [0x1B] = 0x1B,     // ESC
    [0x1C] = 0x1C,     // FS
    [0x1D] = 0x1D,     // GS
    [0x1E] = 0x1E,     // RS
    [0x1F] = 0x1F,     // US
    [0x20] = 0x20,     // Space
    [0x21] = 0x21,     // !
    [0x22] = 0x22,     // "
    [0x23] = 0x23,     // #
    [0x24] = 0x24,     // $
    [0x25] = 0x25,     // %
    [0x26] = 0x26,     // &
    [0x27] = 0x27,     // '
    [0x28] = 0x28,     // (
    [0x29] = 0x29,     // )
    [0x2A] = 0x2A,     // *
    [0x2B] = 0x2B,     // +
    [0x2C] = 0x2C,     // ,
    [0x2D] = 0x2D,     // -
    [0x2E] = 0x2E,     // .
    [0x2F] = 0x2F,     // /
    [0x30] = 0x30,     // 0
    [0x31] = 0x31,     // 1
    [0x32] = 0x32,     // 2
    [0x33] = 0x33,     // 3
    [0x34] = 0x34,     // 4
    [0x35] = 0x35,     // 5
    [0x36] = 0x36,     // 6
    [0x37] = 0x37,     // 7
    [0x38] = 0x38,     // 8
    [0x39] = 0x39,     // 9
    [0x3A] = 0x3A,     // :
    [0x3B] = 0x3B,     // ;
    [0x3C] = 0x3C,     // <
    [0x3D] = 0x3D,     // =
    [0x3E] = 0x3E,     // >
    [0x3F] = 0x3F,     // ?
    [0x40] = 0x40,     // @
    [0x41] = 0x41,     // A
    [0x42] = 0x42,     // B
    [0x43] = 0x43,     // C
    [0x44] = 0x44,     // D
    [0x45] = 0x45,     // E
    [0x46] = 0x46,     // F
    [0x47] = 0x47,     // G
    [0x48] = 0x48,     // H
    [0x49] = 0x49,     // I
    [0x4A] = 0x4A,     // J
    [0x4B] = 0x4B,     // K
    [0x4C] = 0x4C,     // L
    [0x4D] = 0x4D,     // M
    [0x4E] = 0x4E,     // N
    [0x4F] = 0x4F,     // O
    [0x50] = 0x50,     // P
    [0x51] = 0x51,     // Q
    [0x52] = 0x52,     // R
    [0x53] = 0x53,     // S
    [0x54] = 0x54,     // T
    [0x55] = 0x55,     // U
    [0x56] = 0x56,     // V
    [0x57] = 0x57,     // W
    [0x58] = 0x58,     // X
    [0x59] = 0x59,     // Y
    [0x5A] = 0x5A,     // Z
    [0x5B] = 0x5B,     // [
    [0x5C] = 0x5C,     // Backslash
    [0x5D] = 0x5D,     // ]
    [0x5E] = 0x5E,     // ^
    [0x5F] = 0x5F,     // _
    [0x60] = 0x60,     // `
    [0x61] = 0x61,     // a
    [0x62] = 0x62,     // b
    [0x63] = 0x63,     // c
    [0x64] = 0x64,     // d
    [0x65] = 0x65,     // e
    [0x66] = 0x66,     // f
    [0x67] = 0x67,     // g
    [0x68] = 0x68,     // h
    [0x69] = 0x69,     // i
    [0x6A] = 0x6A,     // j
    [0x6B] = 0x6B,     // k
    [0x6C] = 0x6C,     // l
    [0x6D] = 0x6D,     // m
    [0x6E] = 0x6E,     // n
    [0x6F] = 0x6F,     // o
    [0x70] = 0x70,     // p
    [0x71] = 0x71,     // q
    [0x72] = 0x72,     // r
    [0x73] = 0x73,     // s
    [0x74] = 0x74,     // t
    [0x75] = 0x75,     // u
    [0x76] = 0x76,     // v
    [0x77] = 0x77,     // w
    [0x78] = 0x78,     // x
    [0x79] = 0x79,     // y
    [0x7A] = 0x7A,     // z
    [0x7B] = 0x7B,     // {
    [0x7C] = 0x7C,     // |
    [0x7D] = 0x7D,     // }
    [0x7E] = 0x7E,     // ~
    [0x7F] = 0x7F,     // DEL
    [0xE1] = 0xD090,  // À
    [0xE2] = 0xD091,  // Á
    [0xF7] = 0xD092,  // Â
    [0xE7] = 0xD093,  // Ã
    [0xE4] = 0xD094,  // Ä
    [0xE5] = 0xD095,  // Å
    [0xF6] = 0xD096,  // Æ
    [0xFA] = 0xD097,  // Ç
    [0xE9] = 0xD098,  // È
    [0xEA] = 0xD099,  // É
    [0xEB] = 0xD09A,  // Ê
    [0xEC] = 0xD09B,  // Ë
    [0xED] = 0xD09C,  // Ì
    [0xEE] = 0xD09D,  // Í
    [0xEF] = 0xD09E,  // Î
    [0xF0] = 0xD09F,  // Ï
    [0xF2] = 0xD0A0,  // Ð
    [0xF3] = 0xD0A1,  // Ñ
    [0xF4] = 0xD0A2,  // Ò
    [0xF5] = 0xD0A3,  // Ó
    [0xE6] = 0xD0A4,  // Ô
    [0xE8] = 0xD0A5,  // Õ
    [0xE3] = 0xD0A6,  // Ö
    [0xFE] = 0xD0A7,  // ×
    [0xFB] = 0xD0A8,  // Ø
    [0xFD] = 0xD0A9,  // Ù
    [0xFF] = 0xD0AA,  // Ú
    [0xF9] = 0xD0AB,  // Û
    [0xF8] = 0xD0AC,  // Ü
    [0xFC] = 0xD0AD,  // Ý
    [0xE0] = 0xD0AE,  // Þ
    [0xF1] = 0xD0AF,  // ß
    [0xC1] = 0xD0B0,  // à
    [0xC2] = 0xD0B1,  // á
    [0xD7] = 0xD0B2,  // â
    [0xC7] = 0xD0B3,  // ã
    [0xC4] = 0xD0B4,  // ä
    [0xC5] = 0xD0B5,  // å
    [0xD6] = 0xD0B6,  // æ
    [0xDA] = 0xD0B7,  // ç
    [0xC9] = 0xD0B8,  // è
    [0xCA] = 0xD0B9,  // é
    [0xCB] = 0xD0BA,  // ê
    [0xCC] = 0xD0BB,  // ë
    [0xCD] = 0xD0BC,  // ì
    [0xCE] = 0xD0BD,  // í
    [0xCF] = 0xD0BE,  // î
    [0xD0] = 0xD0BF,  // ï
    [0xD2] = 0xD180,  // ð
    [0xD3] = 0xD181,  // ñ
    [0xD4] = 0xD182,  // ò
    [0xD5] = 0xD183,  // ó
    [0xC6] = 0xD184,  // ô
    [0xC8] = 0xD185,  // õ
    [0xC3] = 0xD186,  // ö
    [0xDE] = 0xD187,  // ÷
    [0xDB] = 0xD188,  // ø
    [0xDD] = 0xD189,  // ù
    [0xDF] = 0xD18A,  // ú
    [0xD9] = 0xD18B,  // û
    [0xD8] = 0xD18C,  // ü
    [0xDC] = 0xD18D,  // ý
    [0xC0] = 0xD18E,  // þ
    [0xD1] = 0xD18F   // ÿ
};

unsigned iso8859_5_to_utf8[] = {
    [0x00] = 0x00,     // NULL
    [0x01] = 0x01,     // SOH
    [0x02] = 0x02,     // STX
    [0x03] = 0x03,     // ETX
    [0x04] = 0x04,     // EOT
    [0x05] = 0x05,     // ENQ
    [0x06] = 0x06,     // ACK
    [0x07] = 0x07,     // BEL
    [0x08] = 0x08,     // BS
    [0x09] = 0x09,     // TAB
    [0x0A] = 0x0A,     // LF
    [0x0B] = 0x0B,     // VT
    [0x0C] = 0x0C,     // FF
    [0x0D] = 0x0D,     // CR
    [0x0E] = 0x0E,     // SO
    [0x0F] = 0x0F,     // SI
    [0x10] = 0x10,     // DLE
    [0x11] = 0x11,     // DC1
    [0x12] = 0x12,     // DC2
    [0x13] = 0x13,     // DC3
    [0x14] = 0x14,     // DC4
    [0x15] = 0x15,     // NAK
    [0x16] = 0x16,     // SYN
    [0x17] = 0x17,     // ETB
    [0x18] = 0x18,     // CAN
    [0x19] = 0x19,     // EM
    [0x1A] = 0x1A,     // SUB
    [0x1B] = 0x1B,     // ESC
    [0x1C] = 0x1C,     // FS
    [0x1D] = 0x1D,     // GS
    [0x1E] = 0x1E,     // RS
    [0x1F] = 0x1F,     // US
    [0x20] = 0x20,     // Space
    [0x21] = 0x21,     // !
    [0x22] = 0x22,     // "
    [0x23] = 0x23,     // #
    [0x24] = 0x24,     // $
    [0x25] = 0x25,     // %
    [0x26] = 0x26,     // &
    [0x27] = 0x27,     // '
    [0x28] = 0x28,     // (
    [0x29] = 0x29,     // )
    [0x2A] = 0x2A,     // *
    [0x2B] = 0x2B,     // +
    [0x2C] = 0x2C,     // ,
    [0x2D] = 0x2D,     // -
    [0x2E] = 0x2E,     // .
    [0x2F] = 0x2F,     // /
    [0x30] = 0x30,     // 0
    [0x31] = 0x31,     // 1
    [0x32] = 0x32,     // 2
    [0x33] = 0x33,     // 3
    [0x34] = 0x34,     // 4
    [0x35] = 0x35,     // 5
    [0x36] = 0x36,     // 6
    [0x37] = 0x37,     // 7
    [0x38] = 0x38,     // 8
    [0x39] = 0x39,     // 9
    [0x3A] = 0x3A,     // :
    [0x3B] = 0x3B,     // ;
    [0x3C] = 0x3C,     // <
    [0x3D] = 0x3D,     // =
    [0x3E] = 0x3E,     // >
    [0x3F] = 0x3F,     // ?
    [0x40] = 0x40,     // @
    [0x41] = 0x41,     // A
    [0x42] = 0x42,     // B
    [0x43] = 0x43,     // C
    [0x44] = 0x44,     // D
    [0x45] = 0x45,     // E
    [0x46] = 0x46,     // F
    [0x47] = 0x47,     // G
    [0x48] = 0x48,     // H
    [0x49] = 0x49,     // I
    [0x4A] = 0x4A,     // J
    [0x4B] = 0x4B,     // K
    [0x4C] = 0x4C,     // L
    [0x4D] = 0x4D,     // M
    [0x4E] = 0x4E,     // N
    [0x4F] = 0x4F,     // O
    [0x50] = 0x50,     // P
    [0x51] = 0x51,     // Q
    [0x52] = 0x52,     // R
    [0x53] = 0x53,     // S
    [0x54] = 0x54,     // T
    [0x55] = 0x55,     // U
    [0x56] = 0x56,     // V
    [0x57] = 0x57,     // W
    [0x58] = 0x58,     // X
    [0x59] = 0x59,     // Y
    [0x5A] = 0x5A,     // Z
    [0x5B] = 0x5B,     // [
    [0x5C] = 0x5C,     // Backslash
    [0x5D] = 0x5D,     // ]
    [0x5E] = 0x5E,     // ^
    [0x5F] = 0x5F,     // _
    [0x60] = 0x60,     // `
    [0x61] = 0x61,     // a
    [0x62] = 0x62,     // b
    [0x63] = 0x63,     // c
    [0x64] = 0x64,     // d
    [0x65] = 0x65,     // e
    [0x66] = 0x66,     // f
    [0x67] = 0x67,     // g
    [0x68] = 0x68,     // h
    [0x69] = 0x69,     // i
    [0x6A] = 0x6A,     // j
    [0x6B] = 0x6B,     // k
    [0x6C] = 0x6C,     // l
    [0x6D] = 0x6D,     // m
    [0x6E] = 0x6E,     // n
    [0x6F] = 0x6F,     // o
    [0x70] = 0x70,     // p
    [0x71] = 0x71,     // q
    [0x72] = 0x72,     // r
    [0x73] = 0x73,     // s
    [0x74] = 0x74,     // t
    [0x75] = 0x75,     // u
    [0x76] = 0x76,     // v
    [0x77] = 0x77,     // w
    [0x78] = 0x78,     // x
    [0x79] = 0x79,     // y
    [0x7A] = 0x7A,     // z
    [0x7B] = 0x7B,     // {
    [0x7C] = 0x7C,     // |
    [0x7D] = 0x7D,     // }
    [0x7E] = 0x7E,     // ~
    [0x7F] = 0x7F,     // DEL
    [0xA0] = 0xC2A0,   // Non-breaking space
    [0xB0] = 0xD090,   // À
    [0xB1] = 0xD091,   // Á
    [0xB2] = 0xD092,   // Â
    [0xB3] = 0xD093,   // Ã
    [0xB4] = 0xD094,   // Ä
    [0xB5] = 0xD095,   // Å
    [0xB6] = 0xD096,   // Æ
    [0xB7] = 0xD097,   // Ç
    [0xB8] = 0xD098,   // È
    [0xB9] = 0xD099,   // É
    [0xBA] = 0xD09A,   // Ê
    [0xBB] = 0xD09B,   // Ë
    [0xBC] = 0xD09C,   // Ì
    [0xBD] = 0xD09D,   // Í
    [0xBE] = 0xD09E,   // Î
    [0xBF] = 0xD09F,   // Ï
    [0xC0] = 0xD0A0,   // Ð
    [0xC1] = 0xD0A1,   // Ñ
    [0xC2] = 0xD0A2,   // Ò
    [0xC3] = 0xD0A3,   // Ó
    [0xC4] = 0xD0A4,   // Ô
    [0xC5] = 0xD0A5,   // Õ
    [0xC6] = 0xD0A6,   // Ö
    [0xC7] = 0xD0A7,   // ×
    [0xC8] = 0xD0A8,   // Ø
    [0xC9] = 0xD0A9,   // Ù
    [0xCA] = 0xD0AA,   // Ú
    [0xCB] = 0xD0AB,   // Û
    [0xCC] = 0xD0AC,   // Ü
    [0xCD] = 0xD0AD,   // Ý
    [0xCE] = 0xD0AE,   // Þ
    [0xCF] = 0xD0AF,   // ß
    [0xD0] = 0xD0B0,   // à
    [0xD1] = 0xD0B1,   // á
    [0xD2] = 0xD0B2,   // â
    [0xD3] = 0xD0B3,   // ã
    [0xD4] = 0xD0B4,   // ä
    [0xD5] = 0xD0B5,   // å
    [0xD6] = 0xD0B6,   // æ
    [0xD7] = 0xD0B7,   // ç
    [0xD8] = 0xD0B8,   // è
    [0xD9] = 0xD0B9,   // é
    [0xDA] = 0xD0BA,   // ê
    [0xDB] = 0xD0BB,   // ë
    [0xDC] = 0xD0BC,   // ì
    [0xDD] = 0xD0BD,   // í
    [0xDE] = 0xD0BE,   // î
    [0xDF] = 0xD0BF,   // ï
    [0xE0] = 0xD180,   // ð
    [0xE1] = 0xD181,   // ñ
    [0xE2] = 0xD182,   // ò
    [0xE3] = 0xD183,   // ó
    [0xE4] = 0xD184,   // ô
    [0xE5] = 0xD185,   // õ
    [0xE6] = 0xD186,   // ö
    [0xE7] = 0xD187,   // ÷
    [0xE8] = 0xD188,   // ø
    [0xE9] = 0xD189,   // ù
    [0xEA] = 0xD18A,   // ú
    [0xEB] = 0xD18B,   // û
    [0xEC] = 0xD18C,   // ü
    [0xED] = 0xD18D,   // ý
    [0xEE] = 0xD18E,   // þ
    [0xEF] = 0xD18F    // ÿ
};

int main(int argc, char *argv[]) {

    if (argc < 4){
        printf("Incorrect args list, should be 3: source file, source encoding and output file\n");
        printf("Possible values for encodings: KOI8-R / CP-1251 / ISO8859-5\n");
        printf("Example: ./a.out input.txt KOI8-R output.txt\n");
        return 1;
    }

    if (strcmp(argv[2], "CP-1251") != 0 && strcmp(argv[2], "KOI8-R") != 0 && strcmp(argv[2], "ISO8859-5") != 0){
        printf("Possible values for encodings: KOI8-R / CP-1251 / ISO8859-5\n");
        printf("Example: ./a.out input.txt KOI8-R output.txt\n");
        return 1;
    }

    FILE *input;
    input = fopen(argv[1], "rb");
    if (!input) {
    perror("Error opening input file");
    return 1;
    }

    FILE *output;
    output = fopen(argv[3], "wb");
    if (!output) {
    perror("Error opening output file");
    return 1;
    }

    if (strcmp(argv[2], "CP-1251") == 0 ){
        int readchar;
        while ((readchar = fgetc(input)) != EOF){
            unsigned utf8code = cp1251_to_utf8[readchar];
            unsigned char utf8bytes[2] = {0};
            int length;

            if (utf8code <= 0x7F){
                utf8bytes[0] = (unsigned char)utf8code;
                length = 1;
            }
            else {
                utf8bytes[0] = (unsigned char)((utf8code >> 8) & 0xFF);
                utf8bytes[1] = (unsigned char)(utf8code & 0xFF);
                length = 2;
            }
            fwrite(&utf8bytes, 1, length, output);
        }
    }
    else if (strcmp(argv[2], "KOI8-R") == 0 ){
        int readchar;
        while ((readchar = fgetc(input)) != EOF){
            unsigned utf8code = koi8r_to_utf8[readchar];
            unsigned char utf8bytes[2] = {0};
            int length;

            if (utf8code <= 0x7F){
                utf8bytes[0] = (unsigned char)utf8code;
                length = 1;
            }
            else {
                utf8bytes[0] = (unsigned char)((utf8code >> 8) & 0xFF);
                utf8bytes[1] = (unsigned char)(utf8code & 0xFF);
                length = 2;
            }
            fwrite(&utf8bytes, 1, length, output);
        }
    }
    else if (strcmp(argv[2], "ISO8859-5") == 0 ){
        int readchar;
        while ((readchar = fgetc(input)) != EOF){
            printf("%02x\n", readchar);

            unsigned utf8code = iso8859_5_to_utf8[readchar];
            unsigned char utf8bytes[2] = {0};
            int length;

            if (utf8code <= 0x7F){
                utf8bytes[0] = (unsigned char)utf8code;
                length = 1;
            }
            else {
                utf8bytes[0] = (unsigned char)((utf8code >> 8) & 0xFF);
                utf8bytes[1] = (unsigned char)(utf8code & 0xFF);
                length = 2;
            }
            fwrite(&utf8bytes, 1, length, output);
        }
    }

    fclose(input);
    fclose(output);
    return 0;
}
